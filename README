Based on https://bisqwit.iki.fi/jutut/kuvat/programming_examples/polytut/